(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d3ad0ce4"],{2166:function(e,t,a){"use strict";var c=a("b775");t["a"]={count:function(){return Object(c["a"])({url:"/user/cart/count",method:"get"})},queryByUser:function(){return Object(c["a"])({url:"/user/cart/queryByUser",method:"get"})},add:function(e){return Object(c["a"])({url:"/user/cart/add",method:"POST",data:e})},update:function(e,t){return Object(c["a"])({url:"/user/cart/update/"+e+"/"+t,method:"POST"})}}},"75f4":function(e,t,a){"use strict";var c=a("cc2c"),r=a.n(c);r.a},b775:function(e,t,a){"use strict";a("a481");var c=a("bc3a"),r=a.n(c),n=a("41cb"),o=a("4360"),s=a("5d2d"),i=r.a.create({baseURL:"http://139.129.117.238/api/mobile/",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},withCredentials:!1,timeout:15e3});i.interceptors.request.use((function(e){return s["a"].getToken()&&(e.headers["Authorization"]=s["a"].getToken()),e}),(function(e){return Promise.reject(e)})),i.interceptors.response.use((function(e){console.log("response",e),e.headers.token&&o["a"].dispatch("app/toggleToken",e.headers.token);var t=e.data;return console.log(t.code),1e4==t.code?e:2e4!=t.code?Promise.reject(t.msg||"error"):t}),(function(e){if(e.response)switch(e.response.status){case 401:return o["a"].dispatch("app/toggleUser",{}),o["a"].dispatch("app/toggleToken",""),n["a"].replace({path:"/login",query:{redirect:n["a"].currentRoute.path}}),Promise.reject(e.response.data.message);case 500:return e.response.data.message&&e.response.data.message.indexOf("relogin")>-1?(console.log("need relogin"),o["a"].dispatch("app/toggleUser",{}),o["a"].dispatch("app/toggleToken",""),n["a"].replace({path:"/login",query:{redirect:n["a"].currentRoute.path}}),Promise.reject(e.response.data.message)):Promise.reject(e.response.data.message);default:return Promise.reject(e.response.data.message)}})),t["a"]=i},cc2c:function(e,t,a){},da2a:function(e,t,a){"use strict";a.r(t);var c,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cart"},[e.isLogin&&e.cartList.length>0?a("van-checkbox-group",{staticClass:"card-goods",model:{value:e.checkedGoods,callback:function(t){e.checkedGoods=t},expression:"checkedGoods"}},[e._l(e.cartList,(function(t){return a("div",{key:t.id,staticClass:"card-goods__item"},[a("van-checkbox",{attrs:{name:t.id}}),e._v(" "),a("van-card",{staticStyle:{"margin-left":"15px"},attrs:{title:t.title,desc:t.goods.descript,num:t.count,price:e.formatPrice(t.price),thumb:t.thumb}},[a("div",{attrs:{slot:"footer"},slot:"footer"},[a("van-stepper",{attrs:{disableInput:""},on:{change:function(a){return e.stepperEvent(t,arguments)}},model:{value:t.count,callback:function(a){e.$set(t,"count",a)},expression:"item.count"}})],1)])],1)})),e._v(" "),a("br"),a("br"),a("br"),a("br"),a("br")],2):e._e(),e._v(" "),e.isLogin&&e.cartList.length>0?a("van-submit-bar",{attrs:{price:e.totalPrice,disabled:!e.checkedGoods.length,"button-text":e.submitBarText},on:{submit:e.submit}},[a("van-checkbox",{staticStyle:{padding:"0 10px"},on:{click:e.checkAll},model:{value:e.checkedAll,callback:function(t){e.checkedAll=t},expression:"checkedAll"}},[e._v("全选")])],1):e._e(),e._v(" "),e.isLogin&&0===e.cartList.length?a("div",{staticClass:"no-data"},[a("p",{staticStyle:{"text-align":"center",color:"lightgray"}},[a("van-icon",{staticStyle:{"text-align":"center"},attrs:{name:"cart-o",size:"3rem"}}),a("br"),e._v("\n      购物车还是空的")],1),e._v(" "),a("van-button",{attrs:{type:"default",block:"",round:""},on:{click:e.toHome}},[e._v("去逛逛")])],1):e._e(),e._v(" "),e.isLogin?e._e():a("div",{staticClass:"no-data"},[a("p",{staticStyle:{"text-align":"center",color:"lightgray"}},[a("van-icon",{staticStyle:{"text-align":"center"},attrs:{name:"cart-o",size:"3rem"}}),a("br"),e._v("\n      还没有登录")],1),e._v(" "),a("van-button",{attrs:{type:"primary",block:"",round:""},on:{click:e.toLogin}},[e._v("立即登录")])],1),e._v(" "),a("van-tabbar",{model:{value:e.activeFooter,callback:function(t){e.activeFooter=t},expression:"activeFooter"}},[a("van-tabbar-item",{attrs:{icon:"home-o",replace:"",to:"/index"}},[e._v("首页")]),e._v(" "),a("van-tabbar-item",{attrs:{icon:"search",replace:"",to:"/search"}},[e._v("发现")]),e._v(" "),a("van-tabbar-item",{attrs:{icon:"cart-o",replace:"",to:"/cart"}},[e._v("购物车")]),e._v(" "),a("van-tabbar-item",{attrs:{icon:"user-o",replace:"",to:"/user"}},[e._v("我的")])],1)],1)},n=[],o=a("bd86"),s=(a("c3a6"),a("ad06")),i=(a("66b9"),a("b650")),u=(a("f06a"),a("20fb")),l=(a("a52c"),a("2ed4")),d=(a("537a"),a("ac28")),h=(a("5246"),a("6b41")),p=(a("a909"),a("3acc")),b=(a("be39"),a("efa0")),m=(a("3c32"),a("417e")),g=(a("9cb7"),a("66fd")),v=a("2166"),f=a("4360"),k="/api/mobile/",_={components:(c={},Object(o["a"])(c,g["a"].name,g["a"]),Object(o["a"])(c,m["a"].name,m["a"]),Object(o["a"])(c,b["a"].name,b["a"]),Object(o["a"])(c,p["a"].name,p["a"]),Object(o["a"])(c,h["a"].name,h["a"]),Object(o["a"])(c,d["a"].name,d["a"]),Object(o["a"])(c,l["a"].name,l["a"]),Object(o["a"])(c,u["a"].name,u["a"]),Object(o["a"])(c,i["a"].name,i["a"]),Object(o["a"])(c,s["a"].name,s["a"]),c),data:function(){return{isLogin:!1,activeFooter:2,checkedGoods:[],checkeAllCarts:[],cartList:[],checkedAll:!0}},mounted:function(){this.init()},computed:{submitBarText:function(){var e=this.checkedGoods.length;return"结算"+(e?"(".concat(e,")"):"")},totalPrice:function(){var e=this;return this.cartList.reduce((function(t,a){return t+(-1!==e.checkedGoods.indexOf(a.id)?parseFloat(a.price)*a.count:0)}),0)}},methods:{init:function(){var e=this,t=f["a"].state.app.user;this.isLogin=t.nickName,this.isLogin&&v["a"].queryByUser().then((function(t){var a=t.data;for(var c in a){var r=a[c];r.thumb=k+"/file/getImgStream?idFile="+r.goods.pic,e.checkedGoods.push(a[c].id+"")}e.cartList=a})).catch((function(e){}))},submit:function(){this.$router.push("checkout")},formatPrice:function(e){return(e/100).toFixed(2)},stepperEvent:function(e,t){var a=t[0];v["a"].update(e.id,a)},toHome:function(){this.$router.push("/")},toLogin:function(){this.$router.push({path:"login",query:{redirect:"cart"}})},checkAll:function(){this.checkedGoods.length===this.cartList.length?(this.checkeAllCarts=this.checkedGoods,this.checkedGoods=[]):this.checkedGoods=this.checkeAllCarts}}},j=_,y=(a("75f4"),a("2877")),x=Object(y["a"])(j,r,n,!1,null,null,null);t["default"]=x.exports}}]);